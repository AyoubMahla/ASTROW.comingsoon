<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ASTROW</title>
<style>
@font-face {
  font-family: 'AstrowFont';
  src: url('AstrowFont.ttf') format('opentype');
}

body, html {
  width:100%; height:100%; margin:0; padding:0;
  background:#0a0a0a; font-family:'AstrowFont'; color:#fff;
  display:flex; justify-content:center; align-items:center;
  flex-direction:column; text-align:center; overflow:hidden;
}

canvas {
  position:fixed; top:0; left:0; width:100%; height:100%;
  z-index:0; pointer-events:none;
}

#content {
  position:relative; z-index:1;
  display:flex; flex-direction:column; align-items:center; gap:15px;
}

#logoContainer { display:flex; align-items:center; gap:15px; }
.logo { width:100px; height:auto; }
.star {
  width:100px; height:100px;
  background:url('whitestar.png') no-repeat center/contain;
  animation: spin 5s linear infinite;
}
@keyframes spin { 0%{transform:rotate(0deg);} 100%{transform:rotate(360deg);} }

#subtitle { font-size:25px; margin-bottom:5px; }
#comingSoon { font-size:20px; margin-bottom:5px; max-width:300px; }

#formWrapper {
  display:flex;
  flex-direction:column;
  align-items:center;
  width:90%;
  max-width:550px;
  gap:10px;
}

#registerForm {
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:10px;
  background: rgba(255,255,255,0.05);
  padding:15px;
  border:2px solid #fff;
  border-radius:6px;
  width:100%;
  box-sizing:border-box;
}

/* ✅ LIGNE : Country + Phone + Confirm */
#phoneRow {
  display:flex;
  width:100%;
  gap:10px;
  align-items:center;
}

#countrySelect {
  flex:0 0 90px;
  padding:10px;
  background:rgba(255,255,255,0.15);
  color:#fff;
  border-radius:4px;
  border:none;
  text-align:center;
}

#phoneInput {
  flex:1;
  padding:10px;
  background:rgba(255,255,255,0.15);
  color:#fff;
  border:none;
  border-radius:4px;
  text-align:center;
}

#confirmBtn {
  flex:0 0 120px;
  padding:10px;
  background:#fff;
  color:#000;
  border-radius:4px;
  cursor:pointer;
  transition:0.3s;
}
#confirmBtn:hover {
  background:#000;
  color:#fff;
}

/* ✅ Case à cocher EN DEHORS du cadre */
#consentWrapper {
  font-size:14px;
  color:#fff;
  width:100%;
  display:flex;
  align-items:center;
  gap:6px;
  justify-content:center;
}

#consentWrapper a {
  color:#00ffff;
  text-decoration:none;
}

#errorMessage {
  color:#ff4444;
  font-size:0.9rem;
  margin-top:5px;
  display:none;
  text-align:center;
}
</style>
</head>
<body>

<canvas id="particles"></canvas>

<div id="content">
  <div id="logoContainer">
    <img src="ASTROW.png" alt="ASTROW Logo" class="logo">
    <div class="star"></div>
  </div>

  <div id="subtitle">Aim the stars.</div>
  <div id="comingSoon">
    Coming soon... Enter your number to get notified as soon as the drop goes live 
    and enjoy 10 percent off! PS le site ne marche toujours pas, votre numéro ne sera 
    pas sauvegardé veuillez réessayer plus tard.
  </div>

  <div id="formWrapper">

    <!-- ✅ FORMULAIRE (cadre) -->
    <form id="registerForm">

      <!-- ✅ Country + Phone + Confirm sur une ligne -->
      <div id="phoneRow">
        <select id="countrySelect" name="entry.CountryCode">
          <option value="+33">+33</option>
          <option value="+1">+1</option>
          <option value="+44">+44</option>
          <option value="+49">+49</option>
          <option value="+212">+212</option>
        </select>

        <input type="tel" id="phoneInput" name="entry.PhoneNumber" placeholder="Phone number" required>

        <button type="submit" id="confirmBtn">Confirm</button>
      </div>

    </form>

    <!-- ✅ CASE À COCHER EN DEHORS DU CADRE -->
    <div id="consentWrapper">
      <input type="checkbox" id="consentCheckbox" required>
      <label for="consentCheckbox">
        I consent to receive notifications from ASTROW. See 
        <a href="/privacy" target="_blank">Privacy Policy</a>.
      </label>
    </div>

    <div id="errorMessage"></div>

  </div>
</div>

<script>
// Canvas stars
const canvas = document.getElementById('particles');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let stars = Array.from({ length: 100 }, () => ({
  x: Math.random() * canvas.width,
  y: Math.random() * canvas.height,
  r: Math.random() * 1.5 + 0.5,
  alpha: Math.random() * 0.5 + 0.5,
  delta: Math.random() * 0.02 + 0.005,
  speed: Math.random() * 0.3 + 0.02
}));

function animate() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  stars.forEach(s => {
    s.alpha += s.delta;
    if (s.alpha > 1 || s.alpha < 0.3) s.delta = -s.delta;
    ctx.fillStyle = `rgba(255,255,255,${s.alpha})`;
    ctx.beginPath();
    ctx.arc(s.x, s.y, s.r, 0, 2 * Math.PI);
    ctx.fill();
    s.y += s.speed;
    if (s.y > canvas.height) s.y = 0;
  });
  requestAnimationFrame(animate);
}
animate();

// Formatting
const phoneInput = document.getElementById('phoneInput');
const countrySelect = document.getElementById('countrySelect');

function formatNumberLive(digits, country) {
  switch (country) {
    case '+33': return digits.replace(/(\d{2})(?=\d)/g, '$1 ').trim();
    case '+1': return digits.replace(/^(\d{3})(\d{3})(\d{0,4})/, '($1) $2-$3').trim();
    case '+44': return digits.replace(/^(\d{5})(\d{0,6})/, '$1 $2').trim();
    case '+49': return digits.replace(/^(\d{4})(\d{3,4})(\d{0,4})/, '$1 $2 $3').trim();
    case '+212': return digits.replace(/^(\d{3})(\d{0,6})/, '$1 $2').trim();
    default: return digits;
  }
}

phoneInput.addEventListener('input', e => {
  const pos = e.target.selectionStart;
  const raw = e.target.value;
  const digits = raw.replace(/\D/g, '');
  const formatted = formatNumberLive(digits, countrySelect.value);
  const diff = formatted.length - raw.length;
  e.target.value = formatted;
  e.target.selectionStart = e.target.selectionEnd = pos + diff;
});

// Validation
document.getElementById('registerForm').addEventListener('submit', function(e) {
  e.preventDefault();

  const consentChecked = document.getElementById('consentCheckbox').checked;
  if (!consentChecked) {
    document.getElementById('errorMessage').textContent = 'You must consent.';
    document.getElementById('errorMessage').style.display = 'block';
    return;
  }

  const rawNumber = phoneInput.value.replace(/\D/g, '');
  if (rawNumber.length < 9) {
    document.getElementById('errorMessage').textContent = 'Invalid phone number.';
    document.getElementById('errorMessage').style.display = 'block';
    return;
  }

  document.getElementById('errorMessage').style.display = 'none';
  document.getElementById('content').innerHTML = `
    <div style="font-size:24px;">Your number has been registered!</div>
  `;
});
</script>

</body>
</html>