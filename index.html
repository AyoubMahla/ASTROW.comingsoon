<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ASTROW</title>
<style>
@font-face {
  font-family: 'AstrowFont';
  src: url('AstrowFont.ttf') format('opentype');
}

body, html {
  width:100%; height:100%; margin:0; padding:0;
  background:#0a0a0a; font-family:'AstrowFont'; color:#fff;
  display:flex; justify-content:center; align-items:center;
  flex-direction:column; text-align:center; overflow:hidden;
}

canvas {
  position:fixed; top:0; left:0; width:100%; height:100%;
  z-index:0; pointer-events:none;
}

#content {
  position:relative; z-index:1;
  display:flex; flex-direction:column; align-items:center; gap:15px;
}

#logoContainer { display:flex; align-items:center; gap:15px; }
.logo { width:100px; height:auto; }
.star {
  width:100px; height:100px;
  background:url('whitestar.png') no-repeat center/contain;
  animation: spin 5s linear infinite;
}
@keyframes spin { 0%{transform:rotate(0deg);} 100%{transform:rotate(360deg);} }

#subtitle { font-size:25px; margin-bottom:5px; }
#comingSoon { font-size:20px; margin-bottom:5px; max-width:300px; }

#formWrapper {
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:8px;
  width:90%;
  max-width:550px;
}

#registerForm {
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap:10px;
  background: rgba(255,255,255,0.05);
  padding:15px;
  border:2px solid #fff;
  border-radius:6px;
  width:100%;
  box-sizing:border-box;
}

#countrySelect, #phoneInput, #confirmBtn {
  flex:1;
  min-width:0;
  padding:10px;
  font-size: clamp(0.8rem, 1.2vw, 1rem);
  border:none;
  outline:none;
  font-family:'AstrowFont';
  text-align:center;
  box-sizing:border-box;
}

#countrySelect, #phoneInput {
  background:rgba(255,255,255,0.15);
  color:#fff;
  border-radius:4px;
}

#confirmBtn {
  background:#fff;
  color:#0a0a0a;
  cursor:pointer;
  transition:0.3s;
  border-radius:4px;
  flex:0 0 auto;
}
#confirmBtn:hover { background:#000; color:#fff; }

#consentWrapper {
  font-size:14px;
  color:#fff;
  text-align:left;
  width:100%;
  display:flex;
  align-items:center;
  gap:6px;
}

#consentWrapper a {
  color:#00ffff;
  text-decoration:none;
}

#errorMessage {
  color:#ff4444;
  font-size:0.9rem;
  margin-top:5px;
  display:none;
  text-align:center;
}
</style>
</head>
<body>

<canvas id="particles"></canvas>

<div id="content">
  <div id="logoContainer">
    <img src="ASTROW.png" alt="ASTROW Logo" class="logo">
    <div class="star"></div>
  </div>

  <div id="subtitle">Aim the stars.</div>
  <div id="comingSoon">Coming soon... Enter your number to get notified as soon as the drop goes live and enjoy 10 percent off!</div>

  <div id="formWrapper">
    <form id="registerForm">
      <select id="countrySelect" name="entry.CountryCode">
        <option value="+33">France +33</option>
        <option value="+1">USA +1</option>
        <option value="+44">UK +44</option>
        <option value="+49">Germany +49</option>
        <option value="+212">Morocco +212</option>
      </select>

      <input type="tel" id="phoneInput" name="entry.PhoneNumber" placeholder="Phone number" required>

      <div id="consentWrapper">
        <input type="checkbox" id="consentCheckbox" required>
        <label for="consentCheckbox">
          I consent to receive notifications from ASTROW. See 
          <a href="/privacy" target="_blank">Privacy Policy</a>.
        </label>
      </div>

      <button type="submit" id="confirmBtn">Confirm</button>
    </form>
    <div id="errorMessage"></div>
  </div>
</div>

<script>
// Canvas stars
const canvas = document.getElementById('particles');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let stars = Array.from({ length: 100 }, () => ({
  x: Math.random() * canvas.width,
  y: Math.random() * canvas.height,
  r: Math.random() * 1.5 + 0.5,
  alpha: Math.random() * 0.5 + 0.5,
  delta: Math.random() * 0.02 + 0.005,
  speed: Math.random() * 0.3 + 0.02
}));

function animate() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  stars.forEach(s => {
    s.alpha += s.delta;
    if (s.alpha > 1 || s.alpha < 0.3) s.delta = -s.delta;
    ctx.fillStyle = `rgba(255,255,255,${s.alpha})`;
    ctx.beginPath();
    ctx.arc(s.x, s.y, s.r, 0, 2 * Math.PI);
    ctx.fill();
    s.y += s.speed;
    if (s.y > canvas.height) s.y = 0;
  });
  requestAnimationFrame(animate);
}
animate();
window.addEventListener('resize', () => {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
});

// Live phone formatting
const phoneInput = document.getElementById('phoneInput');
const countrySelect = document.getElementById('countrySelect');
const errorMessage = document.getElementById('errorMessage');

function formatNumberLive(digits, country) {
  switch (country) {
    case '+33': return digits.replace(/(\d{2})(?=\d)/g, '$1 ').trim();
    case '+1': return digits.replace(/^(\d{3})(\d{3})(\d{0,4})/, '($1) $2-$3').trim();
    case '+44': return digits.replace(/^(\d{5})(\d{0,6})/, '$1 $2').trim();
    case '+49': return digits.replace(/^(\d{4})(\d{3,4})(\d{0,4})/, '$1 $2 $3').trim();
    case '+212': return digits.replace(/^(\d{3})(\d{0,6})/, '$1 $2').trim();
    default: return digits;
  }
}

phoneInput.addEventListener('input', (e) => {
  const pos = e.target.selectionStart;
  const raw = e.target.value;
  const digits = raw.replace(/\D/g, '');
  const formatted = formatNumberLive(digits, countrySelect.value);
  
  const diff = formatted.length - raw.length;
  e.target.value = formatted;
  e.target.selectionStart = e.target.selectionEnd = pos + diff;
});

// Validation + consent
document.getElementById('registerForm').addEventListener('submit', function(e) {
  e.preventDefault();

  const consentChecked = document.getElementById('consentCheckbox').checked;
  if (!consentChecked) {
    errorMessage.textContent = 'You must consent to receive notifications.';
    errorMessage.style.display = 'block';
    return;
  }

  const rawNumber = phoneInput.value.replace(/\D/g, '');
  if (rawNumber.length < 9) {
    errorMessage.textContent = 'Please enter a valid phone number.';
    errorMessage.style.display = 'block';
    return;
  }

  errorMessage.style.display = 'none';
  document.getElementById('content').innerHTML = `
    <div style="font-size:24px; font-family:'AstrowFont'; color:#fff;">
      Your number has been registered!<br>
      You will soon receive a confirmation.
    </div>
  `;
});
</script>
</body>
</html>